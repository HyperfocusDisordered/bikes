# üß™ Automated Testing Guide

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Bikes PWA –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç-—Å–∫—Ä–∏–ø—Ç—ã

### 1. API Integration Tests
**–§–∞–π–ª**: `test-api-integration.sh`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –≤—Å–µ API endpoints Clojure backend

```bash
./dev-tools/test-api-integration.sh
```

**–¢–µ—Å—Ç—ã**:
- ‚úÖ GET /api/bikes - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥—ã
- ‚úÖ GET /api/bikes/:id - –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–µ–ª–æ—Å–∏–ø–µ–¥
- ‚úÖ GET /api/bikes/invalid - –ü—Ä–æ–≤–µ—Ä–∫–∞ 404 –æ—à–∏–±–∫–∏
- ‚úÖ POST /api/bikes/:id/reserve - –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞
- ‚úÖ POST /api/rentals/start - –ù–∞—á–∞—Ç—å –∞—Ä–µ–Ω–¥—É
- ‚úÖ GET /api/rentals/current - –¢–µ–∫—É—â–∞—è –∞—Ä–µ–Ω–¥–∞

### 2. End-to-End Test Scenario
**–§–∞–π–ª**: `flutter-test-scenario.sh`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª–Ω—ã–π E2E —Å—Ü–µ–Ω–∞—Ä–∏–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
./dev-tools/flutter-test-scenario.sh
```

**–®–∞–≥–∏**:
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞ Flutter app
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ backend
3. –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–æ–≤
4. –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å–ª–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è
6. –ù–∞—á–∞–ª–æ –∞—Ä–µ–Ω–¥—ã
7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π –∞—Ä–µ–Ω–¥—ã

### 3. Real-time Log Monitoring
**–§–∞–π–ª**: `monitor-logs.sh`
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ Flutter app –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π

```bash
./dev-tools/monitor-logs.sh
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- üîµ API calls –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è —Å–∏–Ω–∏–º
- üî¥ Errors –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–º
- üü¢ Success messages –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è –∑–µ–ª–µ–Ω—ã–º
- üü° Warnings –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è –∂–µ–ª—Ç—ã–º
- üü£ Bike operations –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–º

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç-–æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Terminal 1: –ó–∞–ø—É—Å–∫ Clojure backend
cd backend
export PATH="/opt/homebrew/opt/openjdk@17/bin:$PATH"
clj -M -m bikes-api.simple

# Terminal 2: –ó–∞–ø—É—Å–∫ Flutter app
flutter run -d chrome

# Terminal 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤
./dev-tools/monitor-logs.sh

# Terminal 4: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
./dev-tools/test-api-integration.sh
./dev-tools/flutter-test-scenario.sh
```

## üìä Logging System

### Logger Utility
–§–∞–π–ª: `lib/utils/logger.dart`

**–ú–µ—Ç–æ–¥—ã**:
```dart
// –û–±—ã—á–Ω—ã–π –ª–æ–≥
Logger.log('Message', tag: 'TAG');

// –õ–æ–≥ –æ—à–∏–±–∫–∏
Logger.error('Error message', tag: 'ERROR', error: e, stackTrace: st);

// API –ª–æ–≥
Logger.api('GET', '/api/bikes', params: {...}, statusCode: 200);
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ ApiService

ApiService –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ API –≤—ã–∑–æ–≤—ã:
- üì§ –ü–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º: `[API] GET /api/bikes params: {...}`
- üì• –ü–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞: `[API] GET /api/bikes -> 200`
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: `Loaded 3 bikes from API`

## üéØ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–∞–∑–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å backend –∏ app
# 2. –û—Ç–∫—Ä—ã—Ç—å http://localhost:8080
# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è 3 –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "Loaded 3 bikes from API"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞
```bash
# 1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
# 2. –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –º–∞—Ä–∫–µ—Ä –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞ –Ω–∞ –∫–∞—Ä—Ç–µ
# 3. –ù–∞–∂–∞—Ç—å "Reserve"
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: "Bike bike-X reserved successfully"
# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å—Ç–∞—Ç—É—Å –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞ –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ "Reserved"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ù–∞—á–∞–ª–æ –∞—Ä–µ–Ω–¥—ã
```bash
# 1. –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å –≤–µ–ª–æ—Å–∏–ø–µ–¥
# 2. –ù–∞–∂–∞—Ç—å "Unlock" (QR scanner)
# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: "Rental started for bike bike-X"
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ—Ç–∫—Ä—ã–ª—Å—è RideScreen —Å —Ç–∞–π–º–µ—Ä–æ–º
```

## üîß Troubleshooting

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ—Ä—Ç 3000 —Å–≤–æ–±–æ–¥–µ–Ω
lsof -ti:3000 | xargs kill -9

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Java
java -version  # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–µ—Ä—Å–∏—è 17+
```

### Flutter app –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ API
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω
curl http://localhost:3000/api/bikes

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å lib/services/api_service.dart
# baseUrl –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 'http://localhost:3000'
```

### –ù–µ—Ç –ª–æ–≥–æ–≤ –≤ monitor-logs.sh
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Flutter app –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ /tmp/flutter-chrome.log
tail -f /tmp/flutter-chrome.log
```

## üìà –ú–µ—Ç—Ä–∏–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:

```
API Integration Tests: 6/6 ‚úÖ
E2E Test Scenarios: 7/7 ‚úÖ
Backend Endpoints: 6/6 ‚úÖ
```

## üõ†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
```bash
# Backend health check
curl http://localhost:3000/api/bikes

# Flutter app processes
ps aux | grep flutter

# –õ–æ–≥–∏ backend
tail -f /tmp/backend.log

# –õ–æ–≥–∏ Flutter app
tail -f /tmp/flutter-chrome.log
```

### –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö backend
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend –¥–ª—è —Å–±—Ä–æ—Å–∞ in-memory –¥–∞–Ω–Ω—ã—Ö
lsof -ti:3000 | xargs kill -9
cd backend && clj -M -m bikes-api.simple
```

## üìù Best Practices

1. **–í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º**
2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ E2E —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–≤—ã—Ö —Ñ–∏—á**
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ API integration –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ backend**
5. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ª–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–±–ª–µ–º**

---

Made with ‚ù§Ô∏è for Bikes PWA Testing
